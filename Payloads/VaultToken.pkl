//===----------------------------------------------------------------------===//
//  Copyright (c) 2025 Javier Cuesta
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//  http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//===----------------------------------------------------------------------===//

/// DTO for creating a Token.
///
/// See <https://developer.hashicorp.com/vault/api-docs/auth/token#create-token>
module VaultToken

/// The ID of the client token. Can only be specified by a root token. The ID provided may not contain a . character. Otherwise, the token ID is a randomly generated value.
id: String?

/// The name of the token role.
role_name: String?

/// A list of policies for the token. This must be a subset of the policies belonging to the token making the request, unless the calling token is root or contains sudo capabilities to auth/token/create.
/// If not specified, defaults to all the policies of the calling token.
policies: Listing<String>?

/// A map of string to string valued metadata. This is passed through to the audit devices.
meta: Mapping<String,String>?

/// This argument only has effect if used by a root or sudo caller. When set to true, the token created will not have a parent.
no_parent: Boolean?

/// f true the default policy will not be contained in this token's policy set.
no_default_policy: Boolean?

/// Set to false to disable the ability of the token to be renewed past its initial TTL. Setting the value to true will allow the token to be renewable up to the system/mount maximum TTL.
renewable: Boolean?

/// The TTL period of the token, provided as "1h", where hour is the largest suffix. If not provided, the token is valid for the default lease TTL, or indefinitely if the root policy is used.
ttl: Duration?

typealias TokenType = "batch"|"service"
/// The token type. Can be "batch" or "service". Defaults to the type specified by the role configuration named by `role_name`.
type: TokenType

/// If set, the token will have an explicit max TTL set upon it. This maximum token TTL cannot be changed later, and unlike with normal tokens, updates to the system/mount max TTL value will
/// have no effect at renewal time -- the token will never be able to be renewed or used past the value set at issue time.
explicit_max_ttl: Duration?

///  The display name of the token.
display_name: String?

/// The maximum uses for the given token. This can be used to create a one-time-token or limited use token. The value of 0 has no limit to the number of uses.
num_uses: Int?

/// If specified, the token will be periodic; it will have no maximum TTL (unless an "explicit-max-ttl" is also set) but every renewal will use the given period. Requires a root token or one with the sudo capability.
period: Duration?

/// Name of the entity alias to associate with during token creation. Only works in combination with role_name argument and used entity alias must be listed in allowed_entity_aliases.
/// If this has been specified, the entity will not be inherited from the parent.
entity_alias: String?