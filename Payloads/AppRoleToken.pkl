//===----------------------------------------------------------------------===//
//  Copyright (c) 2025 Javier Cuesta
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//  http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//===----------------------------------------------------------------------===//

/// This is the DTO for generating a new Secret-ID for an AppRole
/// See AppRoleAuth.pkl and [API](https://developer.hashicorp.com/vault/api-docs/auth/approle#parameters-5)
module AppRoleToken

/// Name of the AppRole. Must be less than 4096 bytes.
role_name: String

/// Metadata to be tied to the SecretID. This should be a JSON-formatted string containing the metadata in key-value pairs. This metadata will be set on tokens issued with this SecretID, and is logged in audit logs in plaintext.
meta: Mapping<String,String>?

/// Comma separated string or list of CIDR blocks enforcing secret IDs to be used from specific set of IP addresses.
/// If `secret_id_bound_cidrs` is set on the role, then the list of CIDR blocks listed here should be a subset of the CIDR blocks listed on the role.
cidr_list: Listing<String>?

/// Comma-separated string or list of CIDR blocks; if set, specifies blocks of IP addresses which can use the auth tokens generated by this SecretID. Overrides any role-set value but must be a subset
token_bound_cidrs: Listing<String>?

/// Duration in seconds (3600) or an integer time unit (60m) after which this SecretID expires. A value of zero will allow the SecretID to not expire.
/// Overrides `secret_id_ttl` role option when supplied. May not be longer than role's `secret_id_ttl`.
ttl: Duration?

/// The maximum uses for the given token. This can be used to create a one-time-token or limited use token. The value of 0 has no limit to the number of uses.
num_uses: Int?

/// Set to wrap-response the generated token with the given TTL.
wrap_ttl: String?
